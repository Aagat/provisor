#!/usr/bin/python
# -*- coding: utf8 -*-

import os
import curses
from provisor import Provisor


# fake user object for now
user = {
    'name': 'John Doe',
    'shell': '/bin/bash',
    'login': os.environ.get('SUDO_USER') or os.environ.get('USER'),
    'email': 'user@example.com',
    'keys': {'home':'','work':''}
}


def get_param(prompt_string):
    screen.clear()
    screen.border(0)
    screen.addstr(2, 2, prompt_string)
    screen.refresh()
    input = screen.getstr(10, 10, 60)
    return input

def execute_cmd(cmd_string):
    system("clear")
    a = system(cmd_string)
    print ""
    if a == 0:
        print "Command executed correctly"
    else:
        print "Command terminated with error"
    raw_input("Press enter")
    print ""

x = 0

while x != ord('7'):
    screen = curses.initscr()
    
    screen.clear()
    screen.border(0)
    screen.addstr(2, 2, "User Details:")
    screen.addstr(4, 4, "Login: %s" % user['login'])
    screen.addstr(4, 4, "Name: %s" % user['name'])
    screen.addstr(5, 4, "Email: %s" % user['email'])
    screen.addstr(6, 4, "Shell: %s" % user['shell'])
    screen.addstr(7, 4, "SSH Keys: %s" % ",".join(user['keys'].keys()))
    screen.addstr(10, 2, "Actions:")
    screen.addstr(11, 4, "1 - Change Name")
    screen.addstr(12, 4, "2 - Change Email")
    screen.addstr(13, 4, "3 - Change Shell")
    screen.addstr(14, 4, "4 - View SSH Public Keys")
    screen.addstr(15, 4, "5 - Add SSH Public Keys")
    screen.addstr(16, 4, "6 - Delete SSH Public Key")
    screen.addstr(17, 4, "7 - Exit")
    screen.refresh()
    
    x = screen.getch()
    
    if x == ord('1'):
        user['name'] = get_param("Enter new Name:")
        curses.endwin()
    if x == ord('2'):
        user['email'] = get_param("Enter new Email:")
        curses.endwin()
    if x == ord('3'):
        user['shell'] = get_param("Enter new shell, eg /bin/bash:")
        curses.endwin()

curses.endwin()
